{
  "paragraphs": [
    {
      "text": "%spark \nimport kafka.serializer.StringDecoder\n//import com.datastax.spark.connector.streaming._\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\nimport org.apache.spark.{TaskContext, SparkConf}\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.kafka.{OffsetRange, HasOffsetRanges, KafkaUtils}\nimport org.apache.spark.sql.{Row, SQLContext}\n//import sqlContext.implicits._\nimport spark.implicits._\n\nval ssc \u003d new StreamingContext(sc, Seconds(5))\nimport com.datastax.spark.connector.streaming._\n//val sqlContext \u003d new SQLContext(sc)",
      "dateUpdated": "Aug 29, 2016 3:36:07 PM",
      "config": {
        "tableHide": false,
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1472480179732_279133322",
      "id": "20160726-065534_1308137064",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "\nimport kafka.serializer.StringDecoder\n\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\n\nimport org.apache.spark.{TaskContext, SparkConf}\n\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.streaming.kafka.{OffsetRange, HasOffsetRanges, KafkaUtils}\n\nimport org.apache.spark.sql.{Row, SQLContext}\n\nimport spark.implicits._\n\nssc: org.apache.spark.streaming.StreamingContext \u003d org.apache.spark.streaming.StreamingContext@1dcc0f02\n\nimport com.datastax.spark.connector.streaming._\n"
      },
      "dateCreated": "Aug 29, 2016 2:16:19 AM",
      "dateStarted": "Aug 29, 2016 3:36:07 PM",
      "dateFinished": "Aug 29, 2016 3:36:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark \n  val topicsSet \u003d Set(\"my_topic\")\n  val brokers \u003d sys.env(\"KAFKA_ADDRESS\")\n  val kafkaParams \u003d Map[String, String](\"metadata.broker.list\" -\u003e brokers)\n  val messages \u003d KafkaUtils.createDirectStream[String, String, StringDecoder, StringDecoder](ssc, kafkaParams, topicsSet)\n  val lines \u003d messages.map(_._2)\n  lines.foreachRDD { rdd \u003d\u003e\n        sqlContext.read.json(rdd).registerTempTable(\"mytable\")\n        val averageValues \u003d sqlContext.sql(\"select name as prod, AVG(value) as average from mytable group by name\")\n        averageValues.show()\n        averageValues.write.format(\"org.apache.spark.sql.cassandra\").option(\"header\",\"false\").mode(\"overwrite\").options(Map( \"table\" -\u003e \"results\", \"keyspace\" -\u003e \"mio\")).save()\n  }\n    // Start the computation\n    ssc.start()\n",
      "dateUpdated": "Aug 29, 2016 3:39:20 PM",
      "config": {
        "tableHide": false,
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "graph": {
          "mode": "table",
          "height": 111.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1472480179733_278748573",
      "id": "20160726-072729_926033663",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "\ntopicsSet: scala.collection.immutable.Set[String] \u003d Set(my_topic)\n\nbrokers: String \u003d kafka:9092\n\nkafkaParams: scala.collection.immutable.Map[String,String] \u003d Map(metadata.broker.list -\u003e kafka:9092)\n\nmessages: org.apache.spark.streaming.dstream.InputDStream[(String, String)] \u003d org.apache.spark.streaming.kafka.DirectKafkaInputDStream@1d54d8b8\n\nlines: org.apache.spark.streaming.dstream.DStream[String] \u003d org.apache.spark.streaming.dstream.MappedDStream@34f7f35c\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"
      },
      "dateCreated": "Aug 29, 2016 2:16:19 AM",
      "dateStarted": "Aug 29, 2016 3:39:20 PM",
      "dateFinished": "Aug 29, 2016 3:39:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql\nselect name, AVG(value) from mytable group by name",
      "dateUpdated": "Aug 29, 2016 3:41:07 PM",
      "config": {
        "colWidth": 12.0,
        "editorMode": "ace/mode/sql",
        "helium": {},
        "graph": {
          "mode": "table",
          "height": 168.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "name",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "avg(value)",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "name",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "avg(value)",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1472480179734_279902820",
      "id": "20160726-094150_302242907",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "name\tavg(value)\nprod1\t598.6875\nprod3\t569.0833333333334\nprod4\t505.05882352941177\nprod2\t296.2\n"
      },
      "dateCreated": "Aug 29, 2016 2:16:19 AM",
      "dateStarted": "Aug 29, 2016 3:40:59 PM",
      "dateFinished": "Aug 29, 2016 3:41:00 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark \nssc.awaitTerminationOrTimeout(30 * 1000)\nssc.stop(stopSparkContext\u003dfalse, stopGracefully\u003dtrue)",
      "dateUpdated": "Aug 29, 2016 3:19:31 AM",
      "config": {
        "tableHide": true,
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1472480179734_279902820",
      "id": "20160726-082126_24115141",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "\nres2: Boolean \u003d false\n"
      },
      "dateCreated": "Aug 29, 2016 2:16:19 AM",
      "dateStarted": "Aug 29, 2016 3:19:43 AM",
      "dateFinished": "Aug 29, 2016 3:20:20 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark ",
      "dateUpdated": "Aug 29, 2016 3:19:32 AM",
      "config": {
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1472480179734_279902820",
      "id": "20160726-144125_667601238",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "dateCreated": "Aug 29, 2016 2:16:19 AM",
      "dateStarted": "Aug 29, 2016 3:19:44 AM",
      "dateFinished": "Aug 29, 2016 3:20:20 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Streaming",
  "id": "2BXBZX9TV",
  "lastReplName": {
    "value": "sql"
  },
  "angularObjects": {
    "2BW92AJ26:shared_process": [],
    "2BUE7YEUC:shared_process": [],
    "2BWYTCJZC:shared_process": [],
    "2BX6TPWNA:shared_process": [],
    "2BVS7W5AE:shared_process": [],
    "2BV15NK82:shared_process": [],
    "2BUVCFMWC:shared_process": [],
    "2BX44T9KJ:shared_process": [],
    "2BUQNY71C:shared_process": []
  },
  "config": {},
  "info": {}
}